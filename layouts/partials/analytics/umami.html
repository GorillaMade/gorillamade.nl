{{ if isset site.Params.Analytics.umami "domain" }}
<script data-id="umami-script" async
        src="https://{{ .Params.domain }}/{{ with .Params.scriptName }}{{ . }}{{ else }}script.js{{ end }}"
        data-website-id="{{ site.Params.Analytics.umami.websiteid }}"
        {{ with site.Params.Analytics.umami.dataDomains }}data-domains="{{ . }}"{{ end }}>
</script>
{{ else }}
<script data-id="umami-script" async src="https://analytics.umami.is/script.js"
        data-website-id="{{ .Params.website_id }}">
</script>
{{ end }}

{{ if site.Params.Analytics.umami.enableTrackEvent | default true }}
<script type="text/javascript">
    document.querySelector('script[data-id="umami-script"]')
        .addEventListener('load', function () {
            const type = document.head.querySelector('meta[property = "og:type"]').getAttribute('content');
            let title = document.head.querySelector('meta[property = "og:title"]').getAttribute('content');
            let url = document.head.querySelector('meta[property = "og:url"]').getAttribute('content');
            umami.track(type + ':' + title, {'url': url});
    });
</script>
{{ end }}